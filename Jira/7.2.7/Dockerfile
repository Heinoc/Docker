FROM heinoc/java:1.8

MAINTAINER heinoc <tracychsh@126.com>



# -----------------------------------------------------------------------------
# 下载jira
# -----------------------------------------------------------------------------
RUN axel -n 10 -o /home/work/temp/ https://downloads.atlassian.com/software/jira/downloads/atlassian-jira-software-7.2.7-x64.bin \
    && cd /home/work/temp \
    && chmod 755 atlassian-jira-software-7.2.7-x64.bin \
    \
# -----------------------------------------------------------------------------
# 删除多余文件
# -----------------------------------------------------------------------------
    && yum clean all

# -----------------------------------------------------------------------------
# 复制启动命令
# -----------------------------------------------------------------------------
COPY files/jira-install.sh /home/work/script/jira-install.sh
COPY files/jira-init.sh /home/work/script/jira-init.sh
RUN chmod 777 /home/work/script/jira-init.sh


# -----------------------------------------------------------------------------
# 加入破解文件
# -----------------------------------------------------------------------------
ADD files/jira7.2_hack.zip /home/work/temp


# Define data volumes
VOLUME ["/opt/atlassian", "/var/atlassian"]


# -----------------------------------------------------------------------------
# 映射端口
# -----------------------------------------------------------------------------
EXPOSE 8080 8085 8443 8090

# -----------------------------------------------------------------------------
# 添加执行文件
# -----------------------------------------------------------------------------
ADD run.sh /
RUN chmod +x /run.sh
CMD ["/run.sh"]

